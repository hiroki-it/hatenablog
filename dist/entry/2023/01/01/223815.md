---
Title: Istioã«ã‚ˆã‚‹ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿.md
Category:
- ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥
- Istio
Date: 2023-01-01T22:38:15+09:00
URL: https://hiroki-hasegawa.hatenablog.jp/entry/2023/01/01/223815
EditURL: https://blog.hatena.ne.jp/hiroki-hasegawa/hiroki-hasegawa.hatenablog.jp/atom/entry/4207112889950248449
Draft: true
---

# ç›®æ¬¡

# ã¯ã˜ã‚ã«

ä»Šå›ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã‚’å®Ÿè£…ã™ã‚‹Istioâ›µï¸ã«é–¢ã™ã‚‹è¨˜äº‹ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸã€‚

åŸ·ç­†æ™‚ç‚¹ï¼ˆ2023/01/02ï¼‰ã§ã¯ã€IstioãŒå®Ÿè£…ã™ã‚‹ã‚µãƒ¼ãƒ“ãƒ¡ãƒƒã‚·ãƒ¥ã«ã¯ã€ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ¡ãƒƒã‚·ãƒ¥ã€ã¨ã€ã‚¢ãƒ³ãƒ“ã‚¨ãƒ³ãƒˆãƒ¡ãƒƒã‚·ãƒ¥ã€ãŒã‚ã‚Šã¾ã™ã€‚

ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ¡ãƒƒã‚·ãƒ¥ã®ä»•çµ„ã¿ã®è»¸ã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã¯ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠã§ã‚ã‚‹```istio-proxy```ã‚³ãƒ³ãƒ†ãƒŠã§ã™ã€‚

Istioã¯ã€Kubernetesã®Podã®ä½œæˆã«å¿œã˜ã¦ã€```istio-proxy```ã‚³ãƒ³ãƒ†ãƒŠã‚’è‡ªå‹•çš„ã«Podå†…ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æœ¬è¨˜äº‹ã§ã¯ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿ã‚’ã‚‚ã‚Šã‚‚ã‚Šå¸ƒæ•™ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ï¼ˆæ²¼ã®ã¾ã‚ã‚Šã«é¤Œã‚’ã¾ãï¼‰ã€‚

<br>

# 01. ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã«ã‚ˆã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥

## ãªãœã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãŒå¿…è¦ãªã®ã‹

ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚·ã‚¹ãƒ†ãƒ ã«ã¯ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›ºæœ‰ã®ã‚¤ãƒ³ãƒ•ãƒ©é ˜åŸŸã®èª²é¡Œï¼ˆä¾‹ï¼šã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼ã®å¿…è¦æ€§ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡ã®æš—å·åŒ–ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼åé›†ã€ãªã©ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚

ä¸€ã¤ã®æ–¹æ³•ã¨ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒå„ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å†…ã«ã‚¤ãƒ³ãƒ•ãƒ©é ˜åŸŸã®èª²é¡Œã«é–¢ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã™ã‚Œã°ã€ãã‚Œã‚‰ã‚’è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![service-mesh_layer](https://raw.githubusercontent.com/hiroki-it/tech-notebook/master/images/service-mesh_layer.png)

ã—ã‹ã—ã€ã‚¢ãƒ—ãƒªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯ã‚¢ãƒ—ãƒªé ˜åŸŸã®èª²é¡Œã«è²¬å‹™ã‚’æŒã¡ã€ã‚¤ãƒ³ãƒ•ãƒ©é ˜åŸŸã®èª²é¡Œã¯ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¯è§£æ±ºã™ã‚‹ã‚ˆã†ã«ã—ãŸæ–¹ãŒã€äº’ã„ã«åŠ¹ç‡çš„ã«é–‹ç™ºã§ãã¾ã™ã€‚

ãã“ã§ã€ã‚¤ãƒ³ãƒ•ãƒ©é ˜åŸŸã®èª²é¡Œã‚’è§£æ±ºã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã¨ã—ã¦åˆ‡ã‚Šåˆ†ã‘ã¾ã™ã€‚

![service-mesh_sidecar](https://raw.githubusercontent.com/hiroki-it/tech-notebook/master/images/service-mesh_sidecar.png)

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®è²¬å‹™ã‚’åˆ†é›¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã¾ãŸã‚¤ãƒ³ãƒ•ãƒ©é ˜åŸŸã®å…±é€šãƒ­ã‚¸ãƒƒã‚¯ã¨ã—ã¦ã€å„ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚’æä¾›ã§ãã‚‹ãŸã‚ã€å˜ç´”æ€§ãŒé«˜ã¾ã‚Šã¾ã™ã€‚

> â„¹ï¸ å‚è€ƒï¼š
> 
> - [https://atmarkit.itmedia.co.jp/ait/articles/2110/15/news007.html:title]
> - [https://www.opsmx.com/blog/what-is-service-mesh-and-why-is-it-necessary/:title]

## ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ¡ãƒƒã‚·ãƒ¥

Istioã®ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ãƒ¡ãƒƒã‚·ãƒ¥ã¯ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠï¼ˆ```istio-proxy```ã‚³ãƒ³ãƒ†ãƒŠï¼‰ãŒç¨¼åƒã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ãƒ³ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚’ä¸­å¤®é›†æ¨©çš„ã«ç®¡ç†ã™ã‚‹Istiodï¼ˆ```discovery```ã‚³ãƒ³ãƒ†ãƒŠï¼‰ãŒç¨¼åƒã™ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã€ã‹ã‚‰ãªã‚Šã¾ã™ã€‚

> â„¹ï¸ å‚è€ƒï¼š[https://istio.io/latest/docs/ops/deployment/architecture/:title]

![istio_sidecar-mesh_architecture](https://raw.githubusercontent.com/hiroki-it/tech-notebook/master/images/istio_sidecar-mesh_architecture.png)


<br>

# 02. admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã«ã¤ã„ã¦

## admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã¨ã¯

Istioã®Podå†…ã¸ã®ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å‰æçŸ¥è­˜ã¨ã—ã¦ã€admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã‚‚ã—ã€admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã‚’ã”å­˜çŸ¥ã®æ–¹ã¯ã€é£›ã°ã—ã¦ãã ã•ã„ã€‚

kube-apiserverã§ã¯ã€admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã¨ã—ã¦æœ‰åŠ¹åŒ–ã§ãã¾ã™ã€‚

æœ‰åŠ¹åŒ–ã™ã‚‹ã¨ã€èªè¨¼ã‚¹ãƒ†ãƒƒãƒ—ã¨èªå¯ã‚¹ãƒ†ãƒƒãƒ—ã®å¾Œã«mutating-admissionã‚¹ãƒ†ãƒƒãƒ—ã¨validating-admissionã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã§ãã€ã‚¢ãƒ‰ã‚ªãƒ³ã®ç¨®é¡ã«å¿œã˜ãŸå‡¦ç†ã‚’æŒ¿å…¥ã§ãã¾ã™ã€‚

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆ```kubectl```ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€Kubernetesãƒªã‚½ãƒ¼ã‚¹ï¼‰ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆä¾‹ï¼šKubernetesãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ä½œæˆ/æ›´æ–°/å‰Šé™¤ã€kube-apiserverã‹ã‚‰ã®ãƒ—ãƒ­ã‚­ã‚·ã¸ã®è»¢é€ï¼‰æ™‚ã«ã€å„ã‚¹ãƒ†ãƒƒãƒ—ã§admissionã‚¢ãƒ‰ã‚ªãƒ³ã«ã‚ˆã‚‹å‡¦ç†ï¼ˆä¾‹ï¼šã‚¢ãƒ‰ã‚ªãƒ³ãƒ“ãƒ«ãƒˆã‚¤ãƒ³å‡¦ç†ã€ç‹¬è‡ªå‡¦ç†ï¼‰ã‚’ç™ºç«ã•ã›ã‚‰ã‚Œã¾ã™ã€‚

> â„¹ï¸ å‚è€ƒï¼š[https://www.amazon.com/dp/1492056472/:title]

![kubernetes_admission-controllers_architecture](https://raw.githubusercontent.com/hiroki-it/tech-notebook/master/images/kubernetes_admission-controllers_architecture.png)

## admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã®ç¨®é¡

admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã«ã¯ã€ãŸãã•ã‚“ã®ç¨®é¡ãŒã‚ã‚Šã¾ã™ã€‚

IstioãŒPodå†…ã«ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚’ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹æ™‚ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚¢ãƒ‰ã‚ªãƒ³ã¯ã€ã€MutatingAdmissionWebhookã€ã§ã™ã€‚

- CertificateApproval
- CertificateSigning 
- CertificateSubjectRestriction 
- DefaultIngressClass 
- DefaultStorageClass 
- DefaultTolerationSeconds 
- LimitRanger 
- **MutatingAdmissionWebhook** ğŸ‘ˆ ã“ã‚Œï¼
- NamespaceLifecycle 
- PersistentVolumeClaimResize 
- PodSecurity 
- Priority 
- ResourceQuota 
- RuntimeClass 
- ServiceAccount 
- StorageObjectInUseProtection 
- TaintNodesByCondition 
- ValidatingAdmissionWebhook

> â„¹ï¸ å‚è€ƒï¼š[https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#which-plugins-are-enabled-by-default:title]

## MutatingAdmissionWebhookã‚¢ãƒ‰ã‚ªãƒ³

### MutatingAdmissionWebhookã‚¢ãƒ‰ã‚ªãƒ³ã¨ã¯

MutatingAdmissionWebhookã‚¢ãƒ‰ã‚ªãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€mutating-admissionã‚¹ãƒ†ãƒƒãƒ—æ™‚ã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã‚’å¤‰æ›´ã™ã‚‹å‡¦ç†ã‚’ãƒ•ãƒƒã‚¯ã§ãã‚‹ã€‚

mutating-admissionã‚¹ãƒ†ãƒƒãƒ—æ™‚ã«ã€webhookã‚µãƒ¼ãƒãƒ¼ã«AdmissionRequestã‚’æŒã¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®AdmissionResponseã«å¿œã˜ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã‚’å‹•çš„ã«å¤‰æ›´ã™ã‚‹ã€‚

MutatingWebhookConfigurationã§ã€MutatingAdmissionWebhookã‚¢ãƒ‰ã‚ªãƒ³ã®ç™ºç«æ¡ä»¶ã‚„webhookã‚µãƒ¼ãƒãƒ¼ã®å®›å…ˆæƒ…å ±ã‚’è¨­å®šã™ã‚‹ã€‚

MutatingWebhookConfigurationã®å…·ä½“çš„ãªè¨­å®šå€¤ã«ã¤ã„ã¦ã¯ã€ã‚µã‚¤ãƒ‰ã‚«ãƒ¼ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿ã®ä¸­ã§èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

![mutating-admission-step](https://raw.githubusercontent.com/hiroki-it/tech-notebook/master/images/mutating-admission-step.png)

> â„¹ï¸ å‚è€ƒï¼š
> 
> - [https://medium.com/ibm-cloud/diving-into-kubernetes-mutatingadmissionwebhook-6ef3c5695f74:title]
> - [https://gashirar.hatenablog.com/entry/2020/10/31/141357:title]

### AdmissionReviewã€AdmissionRequestã€AdmissionResponse

AdmissionReviewã¯ä»¥ä¸‹ã®ã‚ˆã†ãªJSONã§ã‚ã‚Šã€kube-apiserverã¨webhookã‚µãƒ¼ãƒãƒ¼ã®é–“ã§AdmissionRequestã¨AdmissionResponseã‚’é‹ã¶ã€‚

```yaml
{
  "apiVersion": "admission.k8s.io/v1",
  "kind": "AdmissionReview",
  # AdmissionRequest
  "request": {},
  # AdmissionResponse
  "response": {}  
}
```

AdmissionRequestã¯ä»¥ä¸‹ã®ã‚ˆã†ãªJSONã§ã‚ã‚‹ã€‚

kube-apiserverãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰å—ä¿¡ã—ãŸæ“ä½œå†…å®¹ãŒæŒã¤ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

ä¾‹ã§æŒ™ã’ãŸAdmissionRequestã§ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒDeploymentã‚’CREATEæ“ä½œã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’kube-apiserverã«é€ä¿¡ã—ãŸã“ã¨ãŒã‚ã‹ã‚‹ã€‚

> â„¹ï¸ å‚è€ƒï¼š[https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#request]

```yaml
{
  "apiVersion": "admission.k8s.io/v1",
  "kind": "AdmissionReview",
  # AdmissionRequest
  "request": {

    # ã€œ ä¸­ç•¥ ã€œ

    # å¤‰æ›´ã•ã‚Œã‚‹Kubernetesãƒªã‚½ãƒ¼ã‚¹ã®ç¨®é¡ã‚’è¡¨ã™ã€‚
    "resource": {
      "group": "apps",
      "version": "v1",
      "resource": "deployments"
    },
    # kube-apiserverã®æ“ä½œã®ç¨®é¡ã‚’è¡¨ã™ã€‚
    "operation": "CREATE",

    # èªè¨¼èªå¯ã•ã‚ŒãŸæ“ä½œã®ç¨®é¡ã‚’è¡¨ã™ã€‚
    "options": {
      "apiVersion": "meta.k8s.io/v1",
      "kind": "CreateOptions"
    },

    # ã€œ ä¸­ç•¥ ã€œ

  }
}
```

å¯¾ã—ã¦AdmissionResponseã¯ã€ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªJSONã§ã‚ã‚‹ã€‚

AdmissionResponseã«å¿œã˜ãŸãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆå¤‰æ›´å‡¦ç†ã‚’```patch```ã‚­ãƒ¼ã®å€¤ã«æŒã¡ã€ã“ã‚Œã¯base64æ–¹å¼ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã€‚

â„¹ï¸ å‚è€ƒï¼š[https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#response:title]

```yaml
{
  "apiVersion": "admission.k8s.io/v1",
  "kind": "AdmissionReview",
  # AdmissionResponse
  "response": {
    "uid": "<value from request.uid>",
    # å®›å…ˆã®webhookã‚µãƒ¼ãƒãƒ¼ãŒå—ä¿¡ã—ãŸã‹å¦ã‹ã‚’è¡¨ã™ã€‚
    "allowed": true,
    # Pathã«ã‚ˆã‚‹Patchå‡¦ç†ã‚’è¡Œã†ã€‚
    "patchType": "JSONPatch",
    # Patchå‡¦ç†ã®å¯¾è±¡ã¨ãªã‚‹Kubernetesãƒªã‚½ãƒ¼ã‚¹ã¨å‡¦ç†å†…å®¹ã‚’è¡¨ã™ã€‚base64æ–¹å¼ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã€‚
    "patch": "W3sib3AiOiAiYWRkIiwgInBhdGgiOiAiL3NwZWMvcmVwbGljYXMiLCAidmFsdWUiOiAzfV0="
  }
}
```

ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰å€¤ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ã¿ã‚‹ã¨ã€ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªpatchå‡¦ç†ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚

ä¾‹ã«æŒ™ã’ãŸ```patch```ã‚­ãƒ¼ã§ã¯ã€ã‚­ãƒ¼ï¼ˆspec.replicasï¼‰ã¨å€¤ï¼ˆ3ï¼‰ã®è¿½åŠ å‡¦ç†ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã«åŠ ãˆã•ã›ã‚‹ã‚ˆã†ã«ã€kube-apiserverã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã—ãŸã“ã¨ãŒã‚ã‹ã‚‹ã€‚

```yaml
# patchã‚­ãƒ¼ã‚’base64æ–¹å¼ã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ãŸå ´åˆ
[
  {
    "op": "add",
    "path": "/spec/replicas",
    "value": 3
  }
]
```

<br>

# 03. ```istio-proxy```ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

## å…¨ä½“åƒ

å‰æçŸ¥è­˜ã‚’è¸ã¾ãˆãŸä¸Šã§ã€admission-controllersã‚¢ãƒ‰ã‚ªãƒ³ã®ä»•çµ„ã¿ã®ä¸­ã§ã€```istio-proxy```ã‚³ãƒ³ãƒ†ãƒŠãŒã©ã®ã‚ˆã†ã«Podã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ã®ã‹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

æœ€åˆã«å…¨ä½“åƒã‚’ãƒã‚¿ãƒãƒ¬ã—ã¦ã—ã¾ã„ã¾ã™ã€‚

![container-injection](https://raw.githubusercontent.com/hiroki-it/tech-notebook/master/images/container-injection.png)

## ï¼ˆï¼‘ï¼‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ â†’ kubeapiserver

ã¾ãšã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒkube-apiserverã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¨ã“ã‚ã§ã™ã€‚

ï¼ˆï¼‘ï¼‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã€Podï¼ˆDeploymentã€DaemonSetã€StatefulSetã€ã‚‚å«ã‚€ï¼‰ã®ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’kube-apiserverã«é€ä¿¡ã—ã¾ã™ã€‚ã“ã®æ™‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã¨ã—ã¾ã™ã€‚



```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: foo-deployment
spec:
  replicas: 2
  selector:
    matchLabels:
      app: foo
  template:
    metadata:
      labels:
        app: foo
    spec:
      containers:
      - name: foo
        image: foo:1.0.0
        ports:
          - containerPort: 80
```





ï¼ˆï¼’ï¼‰kube-apiserverã®èªè¨¼ã‚¹ãƒ†ãƒƒãƒ—ã¨èªå¯ã‚¹ãƒ†ãƒƒãƒ—ã‚’çµŒã¦ã€





